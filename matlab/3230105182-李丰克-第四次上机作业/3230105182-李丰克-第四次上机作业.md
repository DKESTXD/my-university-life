## 1 问题描述

考虑区间[-5, 5]上的函数：$$y=e^{-x^2}$$，在区间上取n个等距插值节点（包括端点），当n分别取3, 5, 9,11时，分别通过拉格朗日插值、牛顿插值和分段线性插值，画出插值多项式函数在[-5, 5]上的图像，与原函数f(x)比较并分析结果。

## 2 问题分析

均分取点可由一个简单循环取出，三种插值方法的原理如下。
拉格朗日插值法：
$$
l_k(x)=\prod^n_{i=0,i\neq k}\frac{x-x_i}{x_k-x_i}\\
L_n(x)=y_0l_0+y_1l_1+...+y_nl_n
$$
牛顿插值法：
$$
f[x_0,...,x_n]=\sum^n_{i=0}\frac{f(x_i)}{\prod^n_{j=0,j\neq i}(x_i-x_j)}\\
N_n(x)=f(x_0)+f[x_0,x_1](x-x_1)+...+f[x_0,...,x_n](x-x_0)...(x-x_n)
$$
分段线性插值是以拉格朗日插值法为基础，每相邻两个值的区间内进行一次线性插值，最终得到分段函数。

## 3 代码实现

首先实现区间内均分点的函数，包含端点

```matlab
function X=separate(d,a,b)
    X=[];
    h=(b-a)/(d-1);
    for i=1:d
        x=a+h*(i-1);
        X=[X,x];
    end    
end
```

定义符号x与原函数$$y=e^{-x^2}$$

```matlab
syms x;
y=exp(-x*x);
```

定义拉格朗日插值法

```matlab
function f=lagrange(x,X,Y)
    n=length(X);
    f=0;
    for i=1:n
        up=1;
        down=1;
        for j=1:n
            if i~=j
                up=up*(x-X(j));%求基函数分子
            end    
        end
        for j=1:n
            if i~=j
                down=down*(X(i)-X(j));%求基函数分母
            end    
        end
        lk=up/down;%基函数
        f=f+Y(i)*lk;%累加
    end
end
```

定义牛顿插值法

```matlab
function result=different(X,Y)%首先定义求差商的函数
    n=length(X);
    result=0;
    for i=1:n
        down=1;
        for j=1:n
            if i~=j
                down=down*(X(i)-X(j));%求分母
            end    
        end 
        lk=Y(i)/down;
        result=result+lk;
    end    
end
```

```matlab
function f=newton(x,X,Y)
    f=Y(1);
    n=length(X);
    for i=2:n
        k=1;
        result=different(X(1:i),Y(1:i));
        k=result;
        for j=1:i-1
            k=k*(x-X(j));
        end
        f=f+k;
    end
end
```

定义分段线性插值法

```matlab
function f=cut(x,X,Y)
    f_set=[];%每个区间的函数的集合
    n=length(X);
    for i=1:n-1
        X_part=X(i:i+1);
        Y_part=Y(i:i+1);
        f_element=lagrange(x,X_part,Y_part);
        f_set=[f_set,f_element];
    end
    f=f_set(1).*(x>=X(1)&x<=X(2));
    disp(f);
    for i=2:length(f_set)
        f=f+f_set(i).*(x>X(i)&x<=X(i+1));%对应区间有对应的函数
    end
end
```

## 4 结果分析

用于画图的代码

```matlab
X=separate(11,-5,5);%取点
disp(X);
Y=[];
for i=1:length(X)
    y0=subs(y,x,X(i));
    Y=[Y,y0];%求Y
end    
f1=lagrange(x,X,Y);
f2=newton(x,X,Y);
f3=cut(x,X,Y);
x=-5:0.01:5;%区间
f1_cal=matlabFunction(f1);
f2_cal=matlabFunction(f2);
f3_cal=matlabFunction(f3);
f4_cal=matlabFunction(y);
f1_y=f1_cal(x);
f2_y=f2_cal(x);
f3_y=f3_cal(x);
f4_y=f4_cal(x);

figure;%窗口一
plot(x,f1_y,'r');
hold on;
plot(x,f2_y,'g');
plot(x,f3_y,'b');
plot(x,f4_y,'k');
legend('f1(x)=拉格朗日', 'f2(x)=牛顿', 'f3(x)=分段线性','f4(x)=原函数');
hold off;

figure;%窗口二
subplot(4,1,1);
plot(x,f1_y,'r');
title('f1(x)=拉格朗日');
subplot(4,1,2);
plot(x,f2_y,'g');
title('f2(x)=牛顿');
subplot(4,1,3);
plot(x,f3_y,'b');
title('f3(x)=分段线性');
subplot(4,1,4);
plot(x,f4_y,'k');
title('f4(x)=原函数');
```

### 4.1 取3个点时

<img src="D:\新建文件夹 (5)\img1\微信截图_20250322200346.png" alt="微信截图_20250322200346" style="zoom: 50%;" /><img src="D:\新建文件夹 (5)\img1\微信截图_20250322200355.png" alt="微信截图_20250322200355" style="zoom: 50%;" />

可见此时三种插值方式得到的函数都与原函数相差较大。

### 4.2 取5个点时

<img src="D:\新建文件夹 (5)\img1\微信截图_20250322200610.png" alt="微信截图_20250322200610" style="zoom: 50%;" /><img src="D:\新建文件夹 (5)\img1\微信截图_20250322200618.png" alt="微信截图_20250322200618" style="zoom: 50%;" />

此时三种插值法都慢慢向原函数趋近。

### 4.3 取9个点时

<img src="D:\新建文件夹 (5)\img1\微信截图_20250322201035.png" alt="微信截图_20250322201035" style="zoom: 50%;" /><img src="D:\新建文件夹 (5)\img1\微信截图_20250322201047.png" alt="微信截图_20250322201047" style="zoom: 50%;" />

此时拉格朗日插值法与牛顿插值法在原函数中间突起的部分大致相等，但是两端波动较大；分段线性整体上与原函数图像最贴近。

### 4.4 取11个点时

<img src="D:\新建文件夹 (5)\img1\微信截图_20250322201339.png" alt="微信截图_20250322201339" style="zoom: 50%;" /><img src="D:\新建文件夹 (5)\img1\微信截图_20250322201348.png" alt="微信截图_20250322201348" style="zoom: 50%;" />

此时拉格朗日插值法与牛顿插值法与原函数中间的部分非常逼近，但是相应的两侧端点处的波动幅度更大了；分段线性插值虽然没有另外两者那么逼近，但是没有出现端点波动(Runge)现象

#### 4.5 分析

当取值过少时，拟合效果固然不佳；但是当取值过多时，拉格朗日与牛顿插值法虽然在原函数某部分逼近效果特别好，但是在其他部分的抖动过大，尤其是端点处，会出现Runge现象，使得计算余项增大，误差增大；分段线性插值虽然逼近速度慢，效果不是最好，但是不会出现Runge现象，始终保持稳定，而且n越大，其与原函数越逼近。
另外，由于插值函数唯一性定理，拉格朗日插值法是与牛顿插值法相等的。

## 5 个人心得

当使用拉格朗日插值法或者牛顿插值法拟合时，建议使用节点数n<7，过多阶次不一定会提高精度，反而会出现Runge现象，增大误差，加密节点并不能保证所得到的插值多项式能更好地逼近f(x)，高次插值效果不一定比低次插值好。而对于分段线性插值，节点数越多，其越逼近原函数，而且计算过程简单，唯一的缺点是不光滑，存在一系列不可导点。如果没有对可导的要求，分段线性插值法是最优解；其次，用合适阶数的拉格朗日插值法或者牛顿插值法也可以逼近。

